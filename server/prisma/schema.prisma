// AAA Permadeath & Hall of Fame Schema
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  username  String   @unique
  password  String
  gold      Int      @default(500)
  fame      Int      @default(0)
  heroes    Hero[]
  inventory InventoryItem[]
}

// Database Utama (Hanya hero yang masih hidup)
model Hero {
  id          String @id @default(uuid())
  userId      String
  user        User   @relation(fields: [userId], references: [id])
  
  templateId  String
  name        String
  race        String
  gender      String   @default("MALE")
  
  level       Int      @default(1)
  exp         Int      @default(0)
  classTier   Int      @default(1) // Tingkat Class (1, 2, 3)
  
  baseStats   String @default("{}")
  naturalTraits    String @default("[]")
  acquiredTraits   String @default("[]")
  unlockedBehaviors String @default("[]")
  activeBehavior    String @default("balanced")
  deeds            String @default("{}")
  
  hasReproduced Boolean @default(false)
  fatherId    String?
  motherId    String?
  generation  Int      @default(1)

  createdAt   DateTime @default(now())
}

// Database Hall of Fame (Arsip Hero Legendaris yang Gugur)
model HallOfFame {
  id          String @id @default(uuid())
  originalId  String
  ownerName   String // Nama user saat hero gugur
  
  name        String
  race        String
  gender      String
  level       Int
  classTier   Int
  generation  Int
  
  finalDeeds  String // Ringkasan pencapaian selama hidup
  deathDate   DateTime @default(now())
  causeOfDeath String
}

model InventoryItem {
  id          String @id @default(uuid())
  userId      String
  user        User   @relation(fields: [userId], references: [id])
  templateId  String
  quantity    Int    @default(1)
  uniqueData  String @default("{}")
  isEquipped  Boolean @default(false)
}